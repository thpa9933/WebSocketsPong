<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Pong</title>
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>

    <script type="text/javascript" src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.3/p5.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.3/addons/p5.dom.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.3/addons/p5.sound.min.js"></script>

    <script>

    var score = 0;
    var isOverRect;
    function setup() {
        createCanvas(windowWidth, windowHeight);
        socket = io.connect('/');

        socket.on('yourScore', function(data) {
            score = data.LS;
            console.log(data.LS);
        });
        
        // window.addEventListener("deviceorientation", handleOrientation, true);
        // function handleOrientation(event){
        //     console.log('gyro data on client is: ' + event.alpha);
        //     var alpha = event.alpha;
        //     socket.emit('gyroData', alpha);
        // }

    }

    function draw() {
        background(0);
        sendmouse(mouseX, mouseY);

        fill(255);
        textSize(70);
        textAlign(CENTER);
        text('Slide horizontally to move!', 500, 500);
        text('Your score is:', 500, 600);
        textSize(200);
        text(score, 500, 900);

        // Reset Button
        if (mouseX >= 300 && mouseX <= 300+400 && mouseY >= 1000 && mouseY <= 1000+200) {
            isOverRect = true;
        } else {
            isOverRect = false;
        }
        ellipseMode(CENTER);
        stroke(0);
        strokeWeight(5);
        if(isOverRect == true) {
            fill (0, 255, 0);
            cursor(HAND);
        } else {
            fill(255,0,0);
            cursor(ARROW);
        }
        textSize(60);
        textAlign(CENTER);
        fill(color(255, 255, 255));
        rect(300, 1000, 400, 200, 15, 15, 15, 15);
        fill(color(255, 0, 0));
        stroke(0);
        text('New Game!', 500, 1125);
    }

    function mousePressed() {
        if(isOverRect == true) {
            socket.emit('resetSketch', true);
        }
    }

    // Sends finger position to server
    function sendmouse(xpos, ypos) {
        var data = {
            x: xpos,
            y: ypos
        };
        socket.emit('mouse1', data);
    }

    </script>
  </head>

  <body>
  </body>
  <style>
      body{
          overflow: hidden;
          margin: 0px;
          overscroll-behavior-y: contain;
      }
  </style>
</html>